# Домашнее задание к занятию "3.7. Компьютерные сети.Лекция 2"

### Цель задания

В результате выполнения этого задания вы:

1. Познакомитесь с инструментами настройки сети в Linux, агрегации нескольких сетевых интерфейсов, отладки их работы.
2. Примените знания о сетевых адресах на практике для проектирования сети.


### Инструкция к заданию

1. Создайте .md-файл для ответов на задания в своём репозитории, после выполнения прикрепите ссылку на него в личном кабинете.
2. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.


### Инструменты/ дополнительные материалы, которые пригодятся для выполнения задания

1. [Калькулятор сетей online](https://calculator.net/ip-subnet-calculator.html).
2. Калькулятор сетей программа - ipcalc (`apt install ipcalc`), если есть графический интерфейс, то у программы калькулятора есть инженерный режим, там можно и сети считать.


------

## Задание

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

<details>
<summary>Ответ</summary>

    Linux: ifconfig
    Windows: ipconfig

</details>

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

<details>
<summary>Ответ</summary>
    
    Для обмена информацией между соседними устройствами используется протоккол LLDP.

    В Linux есть пакет lldpd
    Команда lldpctl

</details>

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

<details>
<summary>Ответ</summary>
    
    Для разделения L2 коммутатора на несколько виртуальных сетей используется технология VLAN.

    В Linux есть пакет vlan
    Команда - vconfig

    
    Проверка, что драйвер (модуль) ядра Linux под названием 8021 загружен:
    # lsmod | grep 8021q

    Если он не загружен, то выполнить команду modprobe:
    # modprobe 8021q


    Создадим VLAN интерфейс с тегом 100 который будет работать на физическом интерфейсе eth0:
    vconfig add eth0 100

    Теперь с помощью ifconfig настроим ip адрес:
    # ifconfig eth0.100 192.168.1.100 netmask 255.255.255.0 broadcast 192.168.1.255 up


    # ifconfig
    eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
            inet 10.0.2.15  netmask 255.255.255.0  broadcast 10.0.2.255
            inet6 fe80::a00:27ff:fe1f:3fcd  prefixlen 64  scopeid 0x20<link>
            ether 08:00:27:1f:3f:cd  txqueuelen 1000  (Ethernet)
            RX packets 4323  bytes 3372275 (3.3 MB)
            RX errors 0  dropped 0  overruns 0  frame 0
            TX packets 2040  bytes 241044 (241.0 KB)
            TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
    
    eth0.100: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
            inet 192.168.1.100  netmask 255.255.255.0  broadcast 192.168.1.255
            inet6 fe80::a00:27ff:fe1f:3fcd  prefixlen 64  scopeid 0x20<link>
            ether 08:00:27:1f:3f:cd  txqueuelen 1000  (Ethernet)
            RX packets 0  bytes 0 (0.0 B)
            RX errors 0  dropped 0  overruns 0  frame 0
            TX packets 6  bytes 516 (516.0 B)
            TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
    
    lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
            inet 127.0.0.1  netmask 255.0.0.0
            inet6 ::1  prefixlen 128  scopeid 0x10<host>
            loop  txqueuelen 1000  (Local Loopback)
            RX packets 40  bytes 3684 (3.6 KB)
            RX errors 0  dropped 0  overruns 0  frame 0
            TX packets 40  bytes 3684 (3.6 KB)
            TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


    # cat /proc/net/vlan/eth0.100 
    eth0.100  VID: 100   REORDER_HDR: 1  dev->priv_flags: 1021
             total frames received            0
              total bytes received            0
          Broadcast/Multicast Rcvd            0
    
          total frames transmitted            9
           total bytes transmitted          726
    Device: eth0
    INGRESS priority mappings: 0:0  1:0  2:0  3:0  4:0  5:0  6:0 7:0
     EGRESS priority mappings: 

</details>

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

<details>
<summary>Ответ</summary>

    Типы агрегации интерфейсов в Linux:

    ● Mode-0(balance-rr) – Данный режим используется по умолчанию. Balance-rr обеспечивается балансировку нагрузки и отказоустойчивость. В данном режиме сетевые пакеты отправляются “по кругу”, от первого интерфейса к последнему. Если выходят из строя интерфейсы, пакеты отправляются на остальные оставшиеся. Дополнительной настройки коммутатора не требуется при нахождении портов в одном коммутаторе. При разностных коммутаторах требуется дополнительная настройка.

    ● Mode-1(active-backup) – Один из интерфейсов работает в активном режиме, остальные в ожидающем. При обнаружении проблемы на активном интерфейсе производится переключение на ожидающий интерфейс. Не требуется поддержки от коммутатора.

    ● Mode-2(balance-xor) – Передача пакетов распределяется по типу входящего и исходящего трафика по формуле ((MAC src) XOR (MAC dest)) % число интерфейсов. Режим дает балансировку нагрузки и отказоустойчивость. Не требуется дополнительной настройки коммутатора/коммутаторов.

    ● Mode-3(broadcast) – Происходит передача во все объединенные интерфейсы, тем самым обеспечивая отказоустойчивость. Рекомендуется только для использования MULTICAST трафика.

    ● Mode-4(802.3ad) – динамическое объединение одинаковых портов. В данном режиме можно значительно увеличить пропускную способность входящего так и исходящего трафика. Для данного режима необходима поддержка и настройка коммутатора/коммутаторов.

    ● Mode-5(balance-tlb) – Адаптивная балансировки нагрузки трафика. Входящий трафик получается только активным интерфейсом, исходящий распределяется в зависимости от текущей загрузки канала каждого интерфейса. Не требуется специальной поддержки и настройки коммутатора/коммутаторов.

    ● Mode-6(balance-alb) – Адаптивная балансировка нагрузки. Отличается более совершенным алгоритмом балансировки нагрузки чем Mode-5). Обеспечивается балансировку нагрузки как исходящего так и входящего трафика. Не требуется специальной поддержки и настройки коммутатора/коммутаторов.



    # cat /etc/netplan/01-netcfg.yaml 
    network:
      version: 2
      ethernets:
        eth0:
          dhcp4: true

</details>

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

<details>
<summary>Ответ</summary>

    На IP адрес с маской /29 остается 3 бита. 2 в степени 3 - 2 = 6 хостов. 
        Один адрес используется для сети, второй для широковещательного запроса.

    Из сети 10.10.10.0/24 можно получить 32 подсети с маской /29.
    
    # ipcalc 10.10.10.0/24 /29
    Address:   10.10.10.0           00001010.00001010.00001010. 00000000
    Netmask:   255.255.255.0 = 24   11111111.11111111.11111111. 00000000
    Wildcard:  0.0.0.255            00000000.00000000.00000000. 11111111
    =>
    Network:   10.10.10.0/24        00001010.00001010.00001010. 00000000
    HostMin:   10.10.10.1           00001010.00001010.00001010. 00000001
    HostMax:   10.10.10.254         00001010.00001010.00001010. 11111110
    Broadcast: 10.10.10.255         00001010.00001010.00001010. 11111111
    Hosts/Net: 254                   Class A, Private Internet
    
    Subnets after transition from /24 to /29
    
    Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
    Wildcard:  0.0.0.7              00000000.00000000.00000000.00000 111
    
     1.
    Network:   10.10.10.0/29        00001010.00001010.00001010.00000 000
    HostMin:   10.10.10.1           00001010.00001010.00001010.00000 001
    HostMax:   10.10.10.6           00001010.00001010.00001010.00000 110
    Broadcast: 10.10.10.7           00001010.00001010.00001010.00000 111
    Hosts/Net: 6                     Class A, Private Internet
    
     2.
    Network:   10.10.10.8/29        00001010.00001010.00001010.00001 000
    HostMin:   10.10.10.9           00001010.00001010.00001010.00001 001
    HostMax:   10.10.10.14          00001010.00001010.00001010.00001 110
    Broadcast: 10.10.10.15          00001010.00001010.00001010.00001 111
    Hosts/Net: 6                     Class A, Private Internet
    
     3.
    Network:   10.10.10.16/29       00001010.00001010.00001010.00010 000
    HostMin:   10.10.10.17          00001010.00001010.00001010.00010 001
    HostMax:   10.10.10.22          00001010.00001010.00001010.00010 110
    Broadcast: 10.10.10.23          00001010.00001010.00001010.00010 111
    Hosts/Net: 6                     Class A, Private Internet
    
    ...
    
    Subnets:   32
    Hosts:     192

</details>

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

<details>
<summary>Ответ</summary>

    20.0.0.0/26

</details>

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

*В качестве решения ответьте на вопросы и опишите, каким образом эти ответы были получены*

<details>
<summary>Ответ</summary>

    ARP-таблица отображает IP-адреса и MAC-адреса подключенных к серверу сетевых устройств.

    Посмотреть в Linux:
    # arp -a
    # arp -n
    Address                  HWtype  HWaddress           Flags Mask            Iface
    10.0.2.2                 ether   52:54:00:12:35:02   C                     eth0
    10.0.2.3                 ether   52:54:00:12:35:03   C                     eth0

    Удалить один ip в Linux:
    # arp -d 10.0.2.3

    # arp -n
    Address                  HWtype  HWaddress           Flags Mask            Iface
    10.0.2.2                 ether   52:54:00:12:35:02   C                     eth0

    Очистить ARP кеш полностью в Linux:
    # ip -s -s neigh flush all
    10.0.2.2 dev eth0 lladdr 52:54:00:12:35:02 ref 1 used 17/0/17 probes 1 REACHABLE
    10.0.2.3 dev eth0 lladdr 52:54:00:12:35:03 used 107/102/62 probes 1 STALE
    
    *** Round 1, deleting 2 entries ***
    *** Flush is complete after 1 round ***



    Посмотреть в Windows:
    > arp -a

    Удалить один ip в Windows:
    > arp -d <ip-address>

    Очистить ARP кеш полностью в Windows:
    netsh interface IP delete arpcache

</details>

---

## Задание для самостоятельной отработки* (необязательно к выполнению)

 8. Установите эмулятор EVE-ng.
 
 [Инструкция по установке](https://github.com/svmyasnikov/eve-ng)

 Выполните задания на lldp, vlan, bonding в эмуляторе EVE-ng. 
 
----

### Правила приема домашнего задания

В личном кабинете отправлена ссылка на .md файл в вашем репозитории.


### Критерии оценки

Зачет - выполнены все задания, ответы даны в развернутой форме, приложены соответствующие скриншоты и файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.

На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки. 
 
Обязательными к выполнению являются задачи без указания звездочки. Их выполнение необходимо для получения зачета и диплома о профессиональной переподготовке.
Задачи со звездочкой (*) являются дополнительными задачами и/или задачами повышенной сложности. Они не являются обязательными к выполнению, но помогут вам глубже понять тему.
